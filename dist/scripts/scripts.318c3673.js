"use strict";angular.module("todoApp",["ngAnimate","ngCookies","ngResource","ui.router","ui.bootstrap","ngSanitize","ngTouch","LocalStorageModule"]).run(["$rootScope","$state","$stateParams",function(a,b,c){a.$state=b,a.$stateParams=c}]).config(["$urlRouterProvider","$locationProvider","localStorageServiceProvider",function(a,b,c){a.otherwise("/todo/list"),b.hashPrefix("!"),c.setStorageType("sessionStorage")}]),angular.module("todoApp").service("todoService",["$http","localStorageService",function(a,b){var c=function(a){var c=b.get("todos");return c||(c={}),c[a.id]=a,b.set("todos",c),!0},d=function(a){var c=a.id;c=a.id+"";var d=b.get("todos");d[a.id]=a,b.set("todos",d)},e=function(a){var c=b.get("todos");delete c[a],b.set("todos",c)},f=function(){var a=b.get("todos");return a},g=function(){var b=a({method:"GET",url:"data/todoData.json",params:{},data:[]});return b.then(function(a){if(200===a.status){var b=a.data;angular.forEach(b,function(a){c(a)})}else window.alert("Error in api call")},function(a){return window.alert("Error in api call"),a}),b},h=function(a){var b=f(),c=null;return angular.forEach(b,function(b){b.id=b.id+"",a+="",b.id===a&&(c=b)}),c};return{getDetail:h,getFromAPI:g,getAll:f,add:c,update:d,remove:e}}]),angular.module("todoApp").controller("todoController",["$scope","todoService","$state",function(a,b,c){a.todoList=b.getAll(),a.edit=function(a){c.transitionTo("todo-add",{id:a})},a.add=function(){c.transitionTo("todo-add")},a.remove=function(c){var d=window.confirm("Are you sure to delete record?");d&&(b.remove(c),a.todoList=b.getAll())}}]),angular.module("todoApp").controller("todoAddController",["$scope","todoService","$state","$stateParams",function(a,b,c,d){var e=d.id,f="";angular.isDefined(e)&&""!==e?(f="Update",a.todos=b.getDetail(e),console.log("todos="),console.log(a.todos)):f="Add",a.assignees=[{id:"1",name:"user1"},{id:"2",name:"user2"},{id:"3",name:"user3"},{id:"4",name:"user4"}],a.types=[{id:"1",name:"New"},{id:"2",name:"Bug"},{id:"3",name:"Addons"}],a.statuses=[{id:"1",name:"Pending"},{id:"2",name:"InProgress"},{id:"3",name:"Finished"},{id:"4",name:"Reviewed"},{id:"5",name:"Closed"}],a.clear=function(){a.dt=null},a.openStartDate=function(b){b.preventDefault(),b.stopPropagation(),a.openedStartDate=!0},a.openEndDate=function(b){b.preventDefault(),b.stopPropagation(),a.openedEndDate=!0},a.dateOptions={formatYear:"yy",startingDay:1},a.format="dd-MMMM-yyyy",a.back=function(){c.transitionTo("todo-list")},a.saveTodo=function(){"Add"===f?(a.todos.id=(new Date).getTime(),b.add(a.todos),c.transitionTo("todo-list")):"Update"===f&&(b.update(a.todos),c.transitionTo("todo-list"))}}]),angular.module("todoApp").config(["$stateProvider",function(a){a.state("todo-list",{url:"/todo/list",controller:"todoController",templateUrl:"views/todoList.html",resolve:{promiseObj:["todoService","localStorageService",function(a,b){if(b.get("todoloaded"))return null;var c=a.getFromAPI();return c.then(function(a){200===a.status&&b.set("todoloaded",!0)},function(){}),c}]}}).state("todo-add",{url:"/todo/add/:id",controller:"todoAddController",templateUrl:"views/todoAdd.html"})}]);